import sys
import pefile
import argparse
import binascii

# Generate and list CRC32 values for all Exports in a given PE file

def main(arguments):
	parser = argparse.ArgumentParser(description=__doc__, formatter_class=argparse.RawDescriptionHelpFormatter)
	parser.add_argument('file', help="file", type=str)
	args = parser.parse_args(arguments)

	pe = pefile.PE(args.file)
	pe.parse_data_directories()

	for exp in pe.DIRECTORY_ENTRY_EXPORT.symbols:
		if(exp.name != None):
			print(exp.name.decode('utf-8') + "; " + hex(binascii.crc32(exp.name)))

if __name__ == '__main__':
    main(sys.argv[1:])
